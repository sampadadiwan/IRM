<%= render FormCard.new(title: "Investments : #{investment.presence || 'New'}") do %>
  <%= form_with(model: investment, validate: true) do |form| %>
    <% if investment.errors.any? %>
      <div class="alert alert-danger">
        <h2><%= pluralize(investment.errors.count, "error") %> prohibited this investment from being saved:</h2>
        <ul>
          <% investment.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :portfolio_company_id, "Portfolio Company" %>
        <%= form.select :portfolio_company_id, 
            investment.entity.investors.portfolio_companies.order(investor_name: :asc).map{|i| [i.investor_name, i.id]}, {include_blank: true}, class: "form-control" %>
    </div>

    <% currencies = investment.entity.exchange_rates.pluck(:from)  %>
    <div class="form-group">
      <%= form.label :currency %>
      <%= form.select :currency, currencies.uniq, {}, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :category %>
      <%= form.select :category, Investment::CATEGORIES, {include_blank: true}, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :investor_name %>
      <%= form.text_field :investor_name, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :investment_type %>
      <%= form.select :investment_type, Investment::TYPES, {include_blank: true}, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :funding_round %>
      <%= form.text_field :funding_round, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :quantity %>
      <%= form.text_field :quantity, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :price %>
      <%= form.text_field :price, class: "form-control"  %>
    </div>
    
    <div class="form-group">
      <%= form.label :investment_date %>
      <%= form.date_field :investment_date, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.label :notes %>
      <%= form.text_area :notes, class: "form-control"  %>
    </div>

    <div class="form-group">
      <%= form.submit t_common(:save), {class: "btn btn-outline-primary"}%>
    </div>
  <% end %>
<% end %>