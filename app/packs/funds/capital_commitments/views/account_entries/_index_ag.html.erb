<% fund ||= nil %>        
<% data_source ||= account_entries_path(params: params.to_unsafe_h, format: :json, all: true, fund_id: params[:fund_id], fund_account_only: params[:fund_account_only], capital_commitment_id: params[:capital_commitment_id], jbuilder: true) %>    
<% lazy_load_data ||= false %>


<div class="table-responsive">

  <div data-controller="account-entries-ag" data-account-entries-ag-lazy-load-data-value=<%= lazy_load_data %>   
    data-account-entries-ag-table-name-value="#account_entries_table">
    

    <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Account Entries</h1>

    <span>
    
      <%  
        if params[:capital_commitment_id].present? || params[:fund_id].present?
            account_entry = AccountEntry.new(capital_commitment_id: params[:capital_commitment_id], fund_id: params[:fund_id]) 
            account_entry.entity_id = account_entry.fund.entity_id
                
      %>

        <%= link_to "New Account Entry", new_account_entry_path("account_entry[capital_commitment_id]": account_entry.capital_commitment_id, "account_entry[entity_id]": account_entry.entity_id, "account_entry[fund_id]": account_entry.fund_id), {class: "btn btn-outline-primary"} if policy(account_entry).new? %>

        <%= link_to "Upload", 
                      new_import_upload_path("import_upload[owner_id]": account_entry.fund_id, 
                      "import_upload[owner_type]": "Fund", 
                      "import_upload[import_type]": "AccountEntry", 
                      "sample_upload": "ACCOUNT_ENTRY_SAMPLE"), 
                      { class: "btn btn-outline-primary"}   %> 

      
      <% end %>

    
      <%= link_to "Download", account_entries_path(capital_commitment_id: params[:capital_commitment_id], 
                              fund_id: params[:fund_id], all: true, format: :xlsx), 
                              class: "btn btn-outline-success" %>
    </span>

  </div>

  <div id="account_entries_table" class="ag-theme-alpine" data-source="<%= data_source %>">
  </div>
  
</div>


</div>
