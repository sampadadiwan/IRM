<%= render "/layouts/alerts" %>

  <table class="table table-bordered dataTable">

    <tr>
      <td class="show_page_label">
        Name
      </td>
      <td>
        <%= @fund.name %>
      </td>
    </tr>
    
    <tr>
      <td>
        Details
      </td>
      <td>
        <%= @fund.details&.html_safe %>
      </td>
    </tr>

    <tr>
      <td>
        Committed Amount
      </td>
      <td>
        <%= money_to_currency @fund.committed_amount, params %>
      </td>
    </tr>
    
    <tr>
      <td>
        Collected Amount
      </td>
      <td>
        <%= money_to_currency @fund.collected_amount, params %>
      </td>
    </tr>

    <tr>
      <td>
        Capital Call Amount
      </td>
      <td>
        <%= money_to_currency @fund.call_amount, params %>
      </td>
    </tr>

    <tr>
      <td>
        Payments Distributed
      </td>
      <td>
        <%= money_to_currency @fund.distribution_amount, params %>
      </td>
    </tr>
    

    <tr>
      <td>
        Entity
      </td>
      <td>
        <%= @fund.entity.name %>
      </td>
    </tr>
    <tr>
      <td>
        Tag List
      </td>
      <td>
        <%= @fund.tag_list %>
      </td>
    </tr>

    <% if @fund.fund_signatory %>
    <tr>
      <td>
        Fund Signatory
      </td>
      <td>
        <%= @fund.fund_signatory.full_name %>
      </td>
    </tr>
    <% end %>

    <% if @fund.trustee_signatory %>
    <tr>
      <td>
        Trustee Signatory
      </td>
      <td>
        <%= @fund.trustee_signatory.full_name %>
      </td>
    </tr>
    <% end %>

    <%= display_custom_fields(@fund) if current_user %>

    <% if policy(@fund).update? %>
      <tr>
        <td>
          Investor Signature Type
        </td>
        <td>
          <%= @fund.investor_signature_types.capitalize %>
        </td>
      </tr>
      <tr>
        <td>
          Fund Signature Type
        </td>
        <td>
          <%= @fund.fund_signature_types.capitalize %>
        </td>
      </tr>
      <tr>
        <td>
          Show Valuations to LPs 
        </td>
        <td>
          <%= display_boolean @fund.show_valuations %>
        </td>
      </tr>
      <tr>
        <td>
          Show Fund Ratios to LPs
        </td>
        <td>
          <%= display_boolean @fund.show_fund_ratios %>
        </td>
      </tr>
    <% end %>
  </table>


  <div>
    <% if policy(@fund).update? %>
      <%= link_to "Edit" , edit_fund_path(@fund), {class: "btn btn-primary" } %> 
      <%= link_to "Timeline" , timeline_fund_path(@fund), {class: "btn btn-success" } %> 
      <%= button_to "Delete" , @fund, method: :delete, class: "btn btn-danger" , form_class: "deleteButton" , data:
            {action: "click->confirm#popup" , turbo:false} if policy(@fund).destroy? %>

      <%= link_to "Import Investors", 
      new_import_upload_path("import_upload[owner_id]": @fund.id, 
          "import_upload[owner_type]": "Fund", 
          "import_upload[import_type]": "Investor", 
          "import_upload[entity_id]": current_user.entity_id,
          "sample_upload": "FUND_INVESTORS_SAMPLE"), 
          { class: "btn btn-primary"}  %> 

    <% end %>

    <%= link_to "Add Investor Notice" , 
                new_investor_notice_path( "investor_notice[owner_id]": @fund.id, 
                "investor_notice[owner_type]": "Fund"), {class: "btn btn-primary" }  %>
  </div>

  <% cache_if(current_user.entity_id == @fund.entity_id, [@fund, "FundDetails"]) do %>
    <%= render "/funds/fund_details", fund: @fund %>
  <% end %>