<% cache_if(current_user != nil, cache_key("formula_stats"), expires_in: 5.day) do %>
  <% colors = ["success", "warning", "danger", "info"].freeze %>

  <% cards_data = [
    { path: fund_formulas_path(fund_id:), stat: policy_scope(FundFormula).where(fund_id:).count, subtitle: "All", progress_bar_color: "success" },
    { path: fund_formulas_path(fund_id:, rule_for: 'accounting'), stat: policy_scope(FundFormula).where(fund_id:).accounting.count, subtitle: "Accounting", progress_bar_color: "warning"},
    { path: fund_formulas_path(fund_id:, rule_for: 'reporting'), stat: policy_scope(FundFormula).where(fund_id:).reporting.count, subtitle: "Reporting", progress_bar_color: "danger"},
    { path: fund_formulas_path(fund_id:, enabled: true), stat: policy_scope(FundFormula).where(fund_id:).enabled.count, subtitle: "Enabled", progress_bar_color: "success"},
    { path: fund_formulas_path(fund_id:, enabled: false), stat: policy_scope(FundFormula).where(fund_id:).disabled.count, subtitle: "Disabled", progress_bar_color: "warning"}
  ] %>

  <div class="row">
    <% cards_data.each do |card_data| %>
      <%= render(NumberStatsComponent.new(
                  path: card_data[:path],
                  amount: card_data[:stat],
                  subtitle: card_data[:subtitle],
                  progress_bar_color: card_data[:progress_bar_color]
      )) %>
    <% end %>
  </div>
<% end %>
