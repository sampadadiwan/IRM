<div class="d-sm-flex align-items-center justify-content-between mb-4">
  <h1 class="h3 mb-0 text-gray-800">Fund Formulas</h1>

  <% if params[:fund_id] %>
    <span>
      <%= link_to "New Fund Formula", new_fund_formula_path("fund_formula[fund_id]": params[:fund_id]), {class: "btn btn-outline-primary"}  if policy(FundFormula.new(fund_id: params[:fund_id])).create? %>

      <%= link_to "Run All", allocate_form_fund_path(id: params[:fund_id]), 
                      class: "btn btn-outline-success"  %> 

      <%= link_to "Download", fund_formulas_path(fund_id: params[:fund_id], format: :xlsx), 
                      class: "btn btn-outline-success"  %>      


      <%= link_to "Upload",
                new_import_upload_path(
                    "import_upload[owner_id]": params[:fund_id],
                    "import_upload[owner_type]": "Fund",
                    "import_upload[import_type]": "FundFormula",
                    "sample_upload": "FUND_FORMULA_SAMPLE"),
                    { class: "btn btn-outline-primary"}  if current_user.has_cached_role?(:support) %>                 
    </span>
  <% end %>

</div>
<div class="table-responsive" data-controller="datatable">
  <table id="fund_formulas" class="table table-bordered dataTable jqDataTable">
    <thead>
      <tr>
        <th>
          Sequence
        </th>
        <th>
          Name
        </th>
        <% if params[:debug].present? %>
          <th>
            Template
          </th>
        <% end %>
        <th>
          Type
        </th>
        <th>
          For
        </th>
        <th>
          Formula
        </th>
        <th>
          Entry Type
        </th>
        <th>
          Roll Up
        </th>
        <th>
          Enabled
        </th>
        
        <th>
        </th>
      </tr>
    </thead>
    <tbody>
      <% fund_formulas.each do |fund_formula| %>
        <%= render fund_formula %>
      <% end %>
    </tbody>
  </table>
</div>
