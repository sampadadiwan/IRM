<% 
  uri_params ||= {}
  fund ||= uri_params[:fund]
  fund_id ||= uri_params[:owner_id].presence || fund&.id
  args ||= {}
  pi_uri = "/portfolio_investments?fund_id=#{fund_id}&ag=true&group_by_column=#{args[:group_by_column]}"
  api_uri = "/aggregate_portfolio_investments?fund_id=#{fund_id}&grid_only=true"
%>

<%= render(
      WidgetCardComponent.new(
        widget: widget,
        args: args,
        widget_size: widget.widget_size
      )
    ) do %>
  <!-- This block becomes the `content` inside the component -->
  <% if args[:ag] %>
      <%= turbo_frame_tag "portfolio_investments_frame", target: "_top", src: pi_uri, loading: :lazy do %>            
      <% end %>
  <% else %>
    <%= turbo_frame_tag "aggregate_portfolio_investments_frame", target: "_top", src: api_uri, lazy: true do %>            
    <% end %>
  <% end %>
<% end %>
