wb = xlsx_package.workbook

wb.add_worksheet(name: "Compliance Checks") do |sheet|
  # Create the header row
  sheet.add_row(["Parent Id", "Parent", "Parent Type", "Owner Id", "Owner", "Owner Type", "Rule", "Status", "Explanation", "Created"])

  # Create entries for each item
  @compliance_checks.each do |cc|
    sheet.add_row [cc.parent.id, cc.parent, cc.parent_type, cc.owner.id, cc.owner, cc.owner_type, cc.compliance_rule.rule, cc.status, cc.explanation, l(cc.created_at)]
  end
end
