<% cache_if(current_user != nil, cache_key("investor_stats"), expires_in: 5.day) do %>


<% colors = ["primary", "success", "danger", "warning", "secondary", "info"].freeze %>

<% index = 0 %>
<div class="row">
    
    <% {Total: import_upload.total_rows_count, Processed: import_upload.processed_row_count, Failed: import_upload.failed_row_count}.each do |category, count| %>
    <% 
        color = colors[index % colors.length]; index += 1 
    %>
    <div class="col-md">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                <div>
                    <h3 class="fs-6"><%= count %></h3>
                    <h6 class="card-subtitle mb-1 text-muted" style="min-height: 30px;"><%= category %></h6>
                </div>
                
                </div>

                <div class="progress-bar text-bg-<%=color%>" role="progressbar" style="width: 100%; height: 6px;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>

            </div>
        </div>        
    </div>
    <% end %>

    <% color = colors[index % colors.length]; index += 1 %>
    <div class="col-md">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                <div>
                    <h3 class="fs-6"><%= link_to "Input", import_upload.import_file.url %></h3>
                    <h6 class="card-subtitle mb-1 text-muted" style="min-height: 30px;"><%= import_upload.import_file.metadata["filename"] %></h6>
                </div>
                
                </div>

                <div class="progress-bar text-bg-<%=color%>" role="progressbar" style="width: 100%; height: 6px;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>

            </div>
        </div>        
    </div>

    <% if import_upload.import_results.present? %>  
    <% color = colors[index % colors.length]; index += 1 %>
    <div class="col-md">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                <div>
                    <h3 class="fs-6"><%= link_to "Result", import_upload.import_results.url %></h3>
                    <h6 class="card-subtitle mb-1 text-muted" style="min-height: 30px;">Results of import</h6>
                </div>
                
                </div>

                <div class="progress-bar text-bg-<%=color%>" role="progressbar" style="width: 100%; height: 6px;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>

            </div>
        </div>        
    </div>
    <% end %>
  
</div>

<% end %>
