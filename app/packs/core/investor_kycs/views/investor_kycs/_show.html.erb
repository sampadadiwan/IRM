<div class="card shadow mb-4">
  <div class="card-header py-3 d-sm-flex align-items-center justify-content-between">
      <h6 class="m-0 font-weight-bold text-primary">Kyc <%= investor_kyc.full_name %></h6>
      <span>
        <a class="btn btn-outline-primary show_details_link" data-bs-toggle="collapse" href=".show_details"><i class="fa-solid fa-caret-down"></i></a>
      </span>
  </div>
  <div class="card-body collapse show show_details">

  <table class="table table-bordered dataTable">

    <tr>
      <td>
        Entity
      </td>
      <td>
        <%= investor_kyc.entity.name %>
      </td>
    </tr>

    <tr>
      <td>
        Residency
      </td>
      <td>
        <%= InvestorKyc.residencies[investor_kyc.residency] %>
      </td>
    </tr>

    <tr>
      <td>
        Kyc Type
      </td>
      <td>
        <%= InvestorKyc.kyc_types[investor_kyc.kyc_type] %>
      </td>
    </tr>


    <tr>
      <td>
        Investor
      </td>
      <td>
        <%= link_to investor_kyc.investor.investor_name, investor_url(investor_kyc.investor, tab: "kycs-tab") %>
      </td>
    </tr>


    <tr>
      <td>
        KYC Verified
      </td>
      <td>
          <%= display_boolean investor_kyc.verified %>
          <div>
            <small>
              <%= "Verified by: " + investor_kyc.verified_by.full_name if investor_kyc.verified && investor_kyc.verified_by %>
            </small>
          </div>
      </td>
    </tr>

    <tr>
      <td>
        Full Name
      </td>
      <td>
        <%= investor_kyc.full_name %>
      </td>
    </tr>

    <tr>
      <td>
        <%= (investor_kyc.kyc_type == "individual") ? "Date Of Birth" : "Date Of Incorporation" %>        
      </td>
      <td>
        <%= investor_kyc.birth_date&.strftime("%d %B, %Y") %>
      </td>
    </tr>

    <tr>
      <td>
        Pan
      </td>
      <td>
        <%= investor_kyc.pan_card.present? ? link_to(investor_kyc.PAN, investor_kyc.pan_card.url, target: "_blank") : investor_kyc.PAN   %>

        <% if investor_kyc.pan_card.present? %>
          <% if investor_kyc.pan_card.mime_type.include?("image") %>
            <br>
            <%= image_tag investor_kyc.pan_card_url,
              style: "margin:0px; padding:0px; max-width:200px; max-height:200px;" %>
          <% end %>
        <% end %>
      </td>
    </tr>

    <tr>
      <td>
        Pan Verified
      </td>
      <td>
          <%= render "investor_kycs/pan_verification", model: investor_kyc, current_user: current_user %>
      </td>
    </tr>

    <tr>
      <td>
        Signature
      </td>
      <td>
        <%= image_tag investor_kyc.signature_url,
          style: "margin:0px; padding:0px; max-width:200px; max-height:200px;" if investor_kyc.signature.present? %>
      </td>
    </tr>

    <tr>
      <td>
        Correspondence Address
      </td>
      <td>
        <%= investor_kyc.corr_address %>
      </td>
    </tr>

    <tr>
      <td>
        Permanent Address
      </td>
      <td>
        <%= investor_kyc.address %>
      </td>
    </tr>


    <tr>
      <td>
        Bank Name
      </td>
      <td>
        <%= investor_kyc.bank_name %>
      </td>
    </tr>
    <tr>
      <td>
        Branch Name
      </td>
      <td>
        <%= investor_kyc.bank_branch %>
      </td>
    </tr>
    <tr>
      <td>
        Bank Account Type
      </td>
      <td>
        <%= investor_kyc.bank_account_type %>
      </td>
    </tr>
    <tr>
      <td>
        Bank Account Number
      </td>
      <td>
        <%= investor_kyc.bank_account_number %>
      </td>
    </tr>
    <tr>
      <td>
        Ifsc Code
      </td>
      <td>
        <%= investor_kyc.ifsc_code %>
      </td>
    </tr>

    <tr>
      <td>
        Bank Verified
      </td>
      <td>
        <%= render "investor_kycs/bank_verification", model: investor_kyc, current_user: current_user %>
      </td>
    </tr>

    <%= display_custom_fields(investor_kyc) if current_user %>

    <tr>
      <td>
        Expiry Date
      </td>
      <td>
        <%= l investor_kyc.expiry_date if investor_kyc.expiry_date %>
        <br>
        <%= render "investor_kycs/expired", investor_kyc:  %>
      </td>
    </tr>



    <tr>
      <td>
        Committed Amount
      </td>
      <td>
        <%= money_to_currency investor_kyc.custom_committed_amount, params %>
      </td>
    </tr>

    <tr>
      <td>
        Collected Amount
      </td>
      <td>
        <%= money_to_currency investor_kyc.collected_amount, params %>
      </td>
    </tr>

    <tr>
      <td>
        Called Amount
      </td>
      <td>
        <%= money_to_currency investor_kyc.call_amount, params %>
      </td>
    </tr>


    <tr>
      <td>
        Distributed Amount
      </td>
      <td>
        <%= money_to_currency investor_kyc.distribution_amount, params %>
      </td>
    </tr>





    <% if params[:debug].present? %>
    <tr>
      <td>
        Bank Verification Response
      </td>
      <td>
        <%= investor_kyc.bank_verification_response %>
      </td>
    </tr>
    <tr>
      <td>
        Bank Verification Status
      </td>
      <td>
        <%= investor_kyc.bank_verification_status %>
      </td>
    </tr>
    <tr>
      <td>
        Signature Data
      </td>
      <td>
        <%= investor_kyc.signature_data %>
      </td>
    </tr>
    <tr>
      <td>
        Pan Card Data
      </td>
      <td>
        <%= investor_kyc.pan_card_data %>
      </td>
    </tr>

    <tr>
      <td>
        Pan Verification Response
      </td>
      <td>
        <%= investor_kyc.pan_verification_response %>
      </td>
    </tr>
    <tr>
      <td>
        Pan Verification Status
      </td>
      <td>
        <%= investor_kyc.pan_verification_status %>
      </td>
    </tr>

    <% end %>

  </table>

  </div>

</div>