<h2><%= @title %></h2>

<table style="border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;">
  <thead>
    <tr style="background-color: #f2f2f2;">
      <th style="border: 1px solid #ddd; padding: 8px;">Status</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Portfolio Company</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Document</th>
      <th style="border: 1px solid #ddd; padding: 8px;">KPI Name</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Sheet</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Period</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Old Value</th>
      <th style="border: 1px solid #ddd; padding: 8px;">New Value</th>
      <th style="border: 1px solid #ddd; padding: 8px;">Message</th>
    </tr>
  </thead>
  <tbody>
    <% if @report_data.present? %>
      <% @report_data.each do |row| %>
        <% r = row.with_indifferent_access %>
        <tr>
          <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">
            <% icon = case r[:status].to_s.downcase
               when 'success' then '✅'
               when 'error' then '❌'
               when 'warning' then '⚠️'
               else 'ℹ️'
            end %>
            <%= icon %>
          </td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:portfolio_company] || '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:document] || '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:kpi_name] || '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:sheet] || '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:period] || '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:old_value].present? ? r[:old_value] : '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:new_value].present? ? r[:new_value] : '—' %></td>
          <td style="border: 1px solid #ddd; padding: 8px;"><%= r[:msg] || r[:message] || '—' %></td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="9" style="text-align: center; color: #888;">No report data available.</td>
      </tr>
    <% end %>
  </tbody>
</table>