<div id="excel_viewer" class="card">
  <% xlsx_as_grid ||= nil %>
  <% if params[:xlsx_as_grid].present? || xlsx_as_grid%>

    <!-- Stimulus XLSX Preview Controller -->
    <div id="xlsx-preview" class="table-responsive"
        data-controller="xlsx-preview"
        data-xlsx-preview-url="<%= document.file_url %>">

      <div data-xlsx-preview-target="card" class="mt-3 d-none">
        <div class="w-auto p-3" data-controller="datatable">
          <div data-xlsx-preview-target="table"></div>
        </div>
      </div>
    </div>

  <% else %>

    <div class="card-header d-none d-sm-block">
      <h6 class="m-0 font-weight-bold text-primary">Viewing: <%= document.name %></h6>
    </div>

    <iframe width="100%" height="600" frameborder="0"
      src="https://view.officeapps.live.com/op/embed.aspx?src=<%= CGI.escape(document.file_url) %>">
    </iframe>

  <% end %>

</div>
