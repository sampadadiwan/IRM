

<%= render "/offers/offer_steps", offer: @offer %>

<%= render "/offers/show" %>


<div>
  <% if policy(@offer).update? %>
    <%= link_to "Edit" , edit_offer_path(@offer), {class: "btn btn-outline-primary" } if !@offer.approved %>
    <%= link_to "Complete Offer Details", edit_offer_path(@offer) , {class: "btn btn-outline-warning" } if @offer.approved %>
  <% end %>

  <% label = @offer.approved ?  "UnApprove" : "Approve" %>
  <%= button_to label , approve_offer_path(@offer), method: :patch, class: "btn btn-outline-success" ,
    form_class: "deleteButton" if Pundit.policy(current_user, @offer).approve? %>


  <%= button_to "Accept SPA" , accept_spa_offer_path(@offer), method: :patch,
      class: "btn btn-outline-success" , id: 'accept_spa_btn',
      form_class: "deleteButton",data: {action: "click->confirm#popup", method: :patch,
      msg: "This will mark your acceptance of the SPA. Proceed?"} if policy(@offer).accept_spa? && @offer.documents&.where(owner_tag: "Generated", approved: true)&.present? %>

  <%= link_to "Secondary Sale" , secondary_sale_path(@offer.secondary_sale), {class: "btn btn-outline-primary" } %>
</div>

<%= render "offers/offer_details", offer: @offer if @offer.approved %>
