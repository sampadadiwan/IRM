<%= render "/layouts/alerts" %>
<table class="table table-bordered dataTable">
   <tr>
      <td>
         Download
      </td>
      <td>
         <%= link_to @document.name, @document.file.expiring_url() if @document.file.exists? %>
      </td>
   </tr>
   <tr>
      <td>
         Created
      </td>
      <td>
         <%= l @document.created_at, format: :default %>
   </tr>
   <tr>
      </td>    
      <td>
         Owner
      </td>
      <td>
         <%= link_to @document.owner.name, @document.owner %>
      </td>
   </tr>
   <tr>
      <td>
         Owner Type
      </td>
      <td>
         <%= @document.owner_type %>
      </td>
   </tr>
   
   <% if @document.text.present? %>
   <tr>
      <td>
         Details
      </td>
      <td>
         <%= @document.text %>
      </td>
   </tr>
   <% end %>

</table>

<% if current_user.entity_id == @document.owner_id %>
   <div style="display: inline-block;">
      <%= link_to "Edit", edit_document_path(@document), {class: "btn btn-primary"} %> |
       <%= button_to "Delete", @document, method: :delete, class: "btn btn-danger", form_class: "deleteButton" %> 
   </div>

   <%= turbo_frame_tag "new_access_right" do %>
      
      | <%= link_to "Grant Access", 
      new_access_right_path("access_right[owner_id]": @document.id,
                            "access_right[access_type]": "Document",
                            "access_right[owner_type]": "Document"), 
            {  method: :get, class: "btn btn-primary", "data-toggle": "tooltip", 
            "title": "Who can access this document"} %> 


   <% end %>
      

   <div id="access_rights" class="associated_entity">
      <%= render "/access_rights/index", access_rights: @document.access_rights %>
   </div>

   <div data-controller="docaccess"></div>

<% end %>