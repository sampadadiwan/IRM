<%= render "/layouts/alerts" %>
<% cache(@approval) do %>
  <%= render "/approvals/show", approval: @approval %>
<% end %>


<div>
  <% if policy(@approval).update? %>
    <%= link_to "Edit", edit_approval_path(@approval), {class: "btn btn-primary"} %> 
    <%= button_to "Delete", @approval, method: :delete, class: "btn btn-danger", form_class: "deleteButton", 
          data: {action: "click->confirm#popup", turbo:false}  %> 
    
  <% end %>
  <%= button_to "Approve", approve_approval_path(@approval), method: :patch, class: "btn btn-success", 
        form_class: "deleteButton", 
        data: {action: "click->confirm#popup", msg: "Approve and send notificatons to investors?", turbo:true, method: :patch} if policy(@approval).approve? && !@approval.approved && @approval.access_rights.count > 0  %>
</div>

<% cache_if(current_user.entity_id == @approval.entity_id, [@approval, "Details"]) do %>
  <%= render "/approvals/approval_details", approval: @approval %>
<% end %>