<% 
    entity_id = params[:entity_id].presence 
    entity = Entity.find(entity_id)
%>

<div data-controller="datatable">
    <div class="col-lg-12 mb-4">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Holdings</h6>
            </div>
            <div class="card-body">
                <%= render "/holdings/index", holdings: policy_scope(Holding).where(entity_id: entity_id), secondary_sale: nil, investor_view: true %>
            </div>
        </div>
    </div>
    <div class="row associated_entity">


        <% 
            if entity.valuations.count > 0
        %>

                    <div class="col-lg-6 mb-4">
                        <%= render "/holdings/investor_calc" %>
                    </div>

                    <div class="col-lg-6 mb-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Projected Profits</h6>
                            </div>
                            <div class="card-body">
                                <%= investor_profits_chart(params, current_user, entity)  %>
                            </div>
                        </div>
                    </div>
            
        <% 
            end 
        %>
    </div>
    
</div>