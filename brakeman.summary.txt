
== Brakeman Report ==

Application Path: /home/thimmaiah/work/IRM
Rails Version: 7.1.3.2
Brakeman Version: 6.1.1
Scan Date: 2024-05-05 12:09:32 +0530
Duration: 31.60774981 seconds
Checks Run: BasicAuth, BasicAuthTimingAttack, CSRFTokenForgeryCVE, ContentTag, CookieSerialization, CreateWith, CrossSiteScripting, DefaultRoutes, Deserialize, DetailedExceptions, DigestDoS, DynamicFinders, EOLRails, EOLRuby, EscapeFunction, Evaluation, Execute, FileAccess, FileDisclosure, FilterSkipping, ForgerySetting, HeaderDoS, I18nXSS, JRubyXML, JSONEncoding, JSONEntityEscape, JSONParsing, LinkTo, LinkToHref, MailTo, MassAssignment, MimeTypeDoS, ModelAttrAccessible, ModelAttributes, ModelSerialize, NestedAttributes, NestedAttributesBypass, NumberToCurrency, PageCachingCVE, Pathname, PermitAttributes, QuoteTableName, Ransack, Redirect, RegexDoS, Render, RenderDoS, RenderInline, ResponseSplitting, RouteDoS, SQL, SQLCVEs, SSLVerify, SafeBufferManipulation, SanitizeConfigCve, SanitizeMethods, SelectTag, SelectVulnerability, Send, SendFile, SessionManipulation, SessionSettings, SimpleFormat, SingleQuotes, SkipBeforeFilter, SprocketsPathTraversal, StripTags, SymbolDoSCVE, TemplateInjection, TranslateBug, UnsafeReflection, UnsafeReflectionMethods, ValidationRegex, VerbConfusion, WeakRSAKey, WithoutProtection, XMLDoS, YAMLParsing

== Overview ==

Controllers: 133
Models: 92
Templates: 1017
Errors: 1
Security Warnings: 39
Ignored Warnings: 21

== Warning Types ==

Command Injection: 2
Cross-Site Scripting: 18
Dynamic Render Path: 3
File Access: 1
HTTP Verb Confusion: 2
Remote Code Execution: 2
SQL Injection: 11

== Obsolete Ignore Entries ==

053047c7baff629f8cb36a76f72aefe6e76b830b3738da3854d0b3a1f4a2633b
0888f0ade3f48d06ff96c2023851d45c121c8261d6ecb79239e982210bd65530
1d764dd701fffc10a7723e5694f8a968140a77a2afced22ad230053d7c7302ec
35c6e24bdc55a3116d92bbe8fbfab6dcd0e38b17d04c14ade5c71d7f591f51dc
36e82ea8b78b74d1475efebf56725bf1b27b7d832e907ce7dbaee838d56e392d
4bb0047d196fefc0d02339de9f38fb0ec7f40e041c120ce63195f31504165ad5
568a7bab04ef328698a6a0f252aae2683a3ae283e621a3f80bc10879eaf7b7ea
5dd95baef92af5266f0557351ed61a62691aba4e09e2c035c7df0d170dc9f8a2
72b69f43d957090d48f35c49ec476f29bfbe8ad7df7c47a6d369a3dad33d9dcb
73373505aea88b7ed924eb9512909bf2d28996ce7192d2fae0e081f9ec778f4a
807f9897c58c293ba36c6a33f20aee4d99f905c732aa87b88f412fee51fb6b54
867feb5f42716e1f4185feb5a74bf475036f4d38a7bfbcfbbff77a46f2b09f6f
b1bafec463525ecb83d31af05a0c7279dca5aaec609aa44f6129d2e41fe358f0
b7a3a78966b8dd15be5401b247c4e36547b3556e5f0067d364e011d837d2a198
baa54cea4eb795a1e840a28af7cc9c08c55ccf04aec230b4149391fee90e578c
bffc45add26a0f4f0e4e213ba088eb572ef2a831a0fde4fcbd6de4579e577d6f
c07d54b236a9f4481ff7fb761f9855c643bb7dc6560a9a4d4a74055f388b12a6
c7fb83a0fdd65c7dc48eecc4a1169cdbd422434c4df494caa13b47dad3579512
cc5ef4e4c5679dc898290999dc89df764fa9a55bf3f64a3526cd688358ece98b
d92c2bf8a5c09ec9ce21f6874f90cd68446faad71c543f32a619166deb20e762
e494ad8a3a3556c89f376a2e176cc7238a99d9ab2243aff28fc53ad80f597686
e7286bb2ef5fc68777e6fab79caac292017776b05527d1a23afc5f06cd8b7057
f13a41a4074a629f865ba32d3b1d99173238648d31409e7c518505f073d86cfe

== Errors ==

Error: app/packs/core/investor_kycs/views/investor_kyc_sebi_datas/_form.html.erb:25 :: parse error on value ":" (tCOLON) Could not parse app/packs/core/investor_kycs/views/investor_kyc_sebi_datas/_form.html.erb
Location: Could not parse /home/thimmaiah/work/IRM/app/packs/core/investor_kycs/views/investor_kyc_sebi_datas/_form.html.erb

== Warnings ==

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: Document.new(document_params).entity.entity_setting.kyc_docs_note
File: app/packs/core/documents/views/documents/new.html.erb
Line: 24

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: Entity.new(entity_params).entity_setting.kyc_docs_note
File: app/packs/core/entities/views/entities/show.html.erb
Line: 115

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: CustomNotification.new(custom_notification_params).body
File: app/packs/core/notifications/views/custom_notifications/show.html.erb
Line: 33

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: CapitalRemittancePayment.new(capital_remittance_payment_params).notes
File: app/packs/funds/capital_remittances/views/capital_remittance_payments/show.html.erb
Line: 72

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: CiWidget.new(ci_widget_params).details
File: app/packs/funds/investment_opportunities/views/ci_widgets/show.html.erb
Line: 58

Confidence: High
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: (Unresolved Model).new.gsub(" ", "&nbsp;")
File: app/packs/startups/option_pools/views/option_pools/show.html.erb
Line: 240

Confidence: High
Category: Dynamic Render Path
Check: Render
Message: Render path contains parameter value
Code: render(action => params[:form_type], { :access_right => AccessRight.new(access_right_params) })
File: app/packs/core/access_rights/views/access_rights/new.html.erb
Line: 3

Confidence: High
Category: Remote Code Execution
Check: UnsafeReflection
Message: Unsafe reflection method `constantize` called on parameter value
Code: params[:owner_type].constantize
File: app/packs/core/documents/controllers/documents_controller.rb
Line: 241

Confidence: Medium
Category: Command Injection
Check: Execute
Message: Possible command injection
Code: system("pdftk #{source_file.path} output #{Rails.root.join("tmp/#{doc.id}.pdf").to_s} user_pw #{custom_notification.attachment_password.split(".").inject(model, &:send)}")
File: app/packs/core/base/mailers/application_mailer.rb
Line: 96

Confidence: Medium
Category: Command Injection
Check: Execute
Message: Possible command injection
Code: `unzip -o #{"#{unzip_dir}/#{File.basename(file.path)}"} -d #{unzip_dir}`
File: app/packs/misc/import_uploads/services/import_service_base.rb
Line: 47

Confidence: Medium
Category: Dynamic Render Path
Check: Render
Message: Render path contains parameter value
Code: render(action => "entities/#{params[:report]}", {})
File: app/packs/core/entities/controllers/entities_controller.rb
Line: 17

Confidence: Medium
Category: Dynamic Render Path
Check: Render
Message: Render path contains parameter value
Code: render(action => "/funds/#{params[:report]}", {})
File: app/packs/funds/funds/controllers/funds_controller.rb
Line: 33

Confidence: Medium
Category: Remote Code Execution
Check: UnsafeReflection
Message: Unsafe reflection method `constantize` called on model attribute
Code: FormType.where(:name => name, :entity_id => eid).order(:id => :asc).first.name.constantize
File: app/packs/misc/form_types/models/form_type.rb
Line: 61

Confidence: Medium
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: Arel.sql("#{table_name}.#{field}_cents / 100.0")
File: app/packs/core/base/models/concerns/ransacker_amounts.rb
Line: 15

Confidence: Medium
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: valuations.update_all("per_share_value_cents = (per_share_value_cents / #{StockAdjustment.find(id).adjustment})")
File: app/packs/funds/portfolios/jobs/stock_adjustment_job.rb
Line: 12

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to(Report.new(report_params).name, Report.new(report_params).url)
File: app/packs/core/base/views/reports/show.html.erb
Line: 24

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to(Report.new(report_params).url, Report.new(report_params).url)
File: app/packs/core/base/views/reports/show.html.erb
Line: 58

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to(Document.new(:entity_id => current_user.entity_id, :owner => nil).file_url, :class => "document_download_icon", :target => "_blank")
File: app/packs/core/documents/views/documents/_document.html.erb
Line: 5

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to(Document.new(document_params).file_url, :class => "btn btn-outline-success", :target => "_blank")
File: app/packs/core/documents/views/documents/show.html.erb
Line: 35

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: Document.new(document_params).tag_list.split(",").collect do  link_to(tag.strip, search_documents_path(:query => tag.strip))  end.join(", ")
File: app/packs/core/documents/views/documents/show.html.erb
Line: 68

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped parameter value
Code: Noticed::Notification.find(params[:id]).email["email"].dig("mail", "body", "raw_source")
File: app/packs/core/notifications/views/notifications/show.html.erb
Line: 67

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped parameter value
Code: Json2table.get_html_table(Noticed::Notification.find(params[:id]).email, :table_class => "table table-bordered dataTable no_hover_table")
File: app/packs/core/notifications/views/notifications/show.html.erb
Line: 72

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to((Unresolved Model).new.file_url, :class => "document_download_icon", :target => "_blank")
File: app/packs/funds/capital_commitments/views/capital_commitments/documents.html.erb
Line: 34

Confidence: Weak
Category: Cross-Site Scripting
Check: LinkToHref
Message: Potentially unsafe model attribute in `link_to` href
Code: link_to("Download Payment Proof", CapitalRemittancePayment.new(capital_remittance_payment_params).payment_proof_url, :target => "_blank", :class => "btn btn-outline-success")
File: app/packs/funds/capital_remittances/views/capital_remittance_payments/show.html.erb
Line: 64

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: Json2table.get_html_table(FundReport.new(fund_report_params).data, :table_class => "table table-bordered dataTable")
File: app/packs/funds/fund_reports/views/fund_reports/show.html.erb
Line: 41

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: Json2table.get_html_table(FundRatio.new(fund_ratio_params).cash_flows, :table_class => "table dataTable")
File: app/packs/funds/funds/views/fund_ratios/show.html.erb
Line: 84

Confidence: Weak
Category: Cross-Site Scripting
Check: CrossSiteScripting
Message: Unescaped model attribute
Code: kpi_percentage_class(kpis.find do  (k.kpi_report.as_of == (Unresolved Model).new)  end, get_invester_kpi_mapping((InvestorKpiMapping.includes(:investor).where(:entity_id => current_user.entity_id).group_by do  [ikm.investor.investor_entity_id, ikm.reported_kpi_name]  end or nil), kpis.first))
File: app/packs/startups/kpis/views/kpis/_grid_view.html.erb
Line: 64

Confidence: Weak
Category: File Access
Check: SendFile
Message: Model attribute used in file name
Code: send_file(FundXlExport.new.generate(Fund.find(params[:id])), :type => "application/vnd.ms-excel", :filename => ("#{Fund.find(params[:id]).name}.xlsx"), :stream => false)
File: app/packs/funds/funds/controllers/funds_controller.rb
Line: 13

Confidence: Weak
Category: HTTP Verb Confusion
Check: VerbConfusion
Message: Potential HTTP verb confusion. `HEAD` is routed like `GET` but `request.get?` will return `false`
Code: if request.get? then   authorize(Entity, :merge?)   render(action => "merge", {}) else   defunct_entity = Entity.find(params[:old_entity_id])   authorize(Entity.find(params[:old_entity_id]), :merge?)   retained_entity = Entity.find(params[:new_entity_id])   authorize(Entity.find(params[:new_entity_id]), :merge?)   Entity.merge_investor_entity(Entity.find(params[:old_entity_id]), Entity.find(params[:new_entity_id]))   redirect_to(entity_url(new_entity), :notice => "Entity Merge Completed") end
File: app/packs/core/entities/controllers/entities_controller.rb
Line: 85

Confidence: Weak
Category: HTTP Verb Confusion
Check: VerbConfusion
Message: Potential HTTP verb confusion. `HEAD` is routed like `GET` but `request.get?` will return `false`
Code: if request.get? then   render(action => "merge", {}) else   old_investor = Investor.find(params[:old_investor_id])   new_investor = Investor.find(params[:new_investor_id])   authorize(Investor.find(params[:old_investor_id]), :update?)   authorize(Investor.find(params[:new_investor_id]), :update?)   InvestorMergeJob.perform_later(Investor.find(params[:old_investor_id]).id, Investor.find(params[:new_investor_id]).id, current_user.id)   redirect_to(investor_url(Investor.find(params[:new_investor_id])), :notice => "Investor merge in progress, please check back in a few mins") end
File: app/packs/core/investors/controllers/investors_controller.rb
Line: 22

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: object.send(association).where("#{filter_field}=?", filter_value.to_s.tr("_", " ").humanize.titleize)
File: app/packs/core/base/decorators/template_decorator.rb
Line: 3

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: object.where("#{filter_field}=?", filter_value.to_s.tr("_", " ").humanize)
File: app/packs/core/base/decorators/template_decorator.rb
Line: 12

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: join_clause.where("#{parent_class_type.name.underscore.pluralize}.entity_id in (?)", user.entity.child_ids)
File: app/packs/core/investors/models/concerns/for_investor.rb
Line: 28

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: join_clause.where("#{parent_class_type.name.underscore.pluralize}.entity_id = ?", user.entity_id)
File: app/packs/core/investors/models/concerns/for_investor.rb
Line: 30

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: join_clause.where("#{parent_class_type.name.underscore.pluralize}.entity_id in (?) and access_rights.user_id=?", user.entity.child_ids, user.id)
File: app/packs/core/investors/models/concerns/for_investor.rb
Line: 41

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: join_clause.where("#{parent_class_type.name.underscore.pluralize}.entity_id=? and access_rights.user_id=? and access_rights.entity_id=?", user.entity_id, user.id, user.entity_id)
File: app/packs/core/investors/models/concerns/for_investor.rb
Line: 43

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: fund.capital_commitments.pool.update_all("percentage=100.0*committed_amount_cents/#{fund.capital_commitments.pool.sum(:committed_amount_cents)}")
File: app/packs/funds/capital_commitments/models/capital_commitment.rb
Line: 170

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: fund.capital_commitments.co_invest.update_all("percentage=100.0*committed_amount_cents/#{fund.capital_commitments.co_invest.sum(:committed_amount_cents)}")
File: app/packs/funds/capital_commitments/models/capital_commitment.rb
Line: 173

Confidence: Weak
Category: SQL Injection
Check: SQL
Message: Possible SQL injection
Code: kpi_report.form_type.form_custom_fields.where("meta_data like '%#{name.downcase.strip}%'")
File: app/packs/startups/kpis/models/kpi.rb
Line: 29

