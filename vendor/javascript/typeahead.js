// typeahead@0.2.2 downloaded from https://ga.jspm.io/npm:typeahead@0.2.2/typeahead.js

import e from"xtend";import t from"dom";var n="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var r={};var i=e;var s=t;var o={source:[],items:8,menu:'<ul class="typeahead hidden"></ul>',item:'<li><a href="#"></a></li>',minLength:1,autoselect:true};var Typeahead=function(e,t){if(!((this||n)instanceof Typeahead))return new Typeahead(e,t);var r=this||n;r.element=s(e);r.options=i({},o,t);r.matcher=r.options.matcher||r.matcher;r.sorter=r.options.sorter||r.sorter;r.highlighter=r.options.highlighter||r.highlighter;r.updater=r.options.updater||r.updater;r.menu=s(r.options.menu);s(document.body).append(r.menu);r.source=r.options.source;r.shown=false;r.listen()};var a=Typeahead.prototype;a.constructor=Typeahead;a.select=function(){var e=this||n;var t=e.menu.find(".active").attr("data-value");e.element.value(e.updater(t)).emit("change");return e.hide()};a.updater=function(e){return e};a.show=function(){var e=this||n;var t=e.element.offset();var r=i({},t,{height:e.element.outerHeight()});var s=0;var o=e.element[0];while(o=o.parentElement){var a=o.tagName.toLowerCase();"html"!==a&&"body"!==a&&(s+=o.scrollTop)}var u=r.top+r.height-s+"px";var h="auto";var c=r.left+"px";if("above"===e.options.position){u="auto";h=document.body.clientHeight-r.top+3}else if("right"===e.options.position){u=parseInt(u.split("px")[0],10)-e.element.outerHeight()+"px";c=parseInt(c.split("px")[0],10)+e.element.outerWidth()+"px"}e.menu.css({top:u,bottom:h,left:c});e.menu.removeClass("hidden");e.shown=true;return e};a.hide=function(){(this||n).menu.addClass("hidden");(this||n).shown=false;return this||n};a.lookup=function(e){var t=this||n;t.query=t.element.value();if(!t.query||t.query.length<t.options.minLength)return t.shown?t.hide():t;t.source instanceof Function?t.source(t.query,t.process.bind(t)):t.process(t.source);return t};a.process=function(e){var t=this||n;e=e.filter(t.matcher.bind(t));e=t.sorter(e);return e.length?t.render(e.slice(0,t.options.items)).show():t.shown?t.hide():t};a.matcher=function(e){return~e.toLowerCase().indexOf((this||n).query.toLowerCase())};a.sorter=function(e){var t=[];var r=[];var i=[];var s;while(s=e.shift())s.toLowerCase().indexOf((this||n).query.toLowerCase())?~s.indexOf((this||n).query)?r.push(s):i.push(s):t.push(s);return t.concat(r,i)};a.highlighter=function(e){var t=(this||n).query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),(function(e,t){return"<strong>"+t+"</strong>"}))};a.render=function(e){var t=this||n;e=e.map((function(e){var n=s(t.options.item);n.attr("data-value",e).find("a").html(t.highlighter(e));return n}));t.options.autoselect&&e[0].addClass("active");t.menu.empty();e.forEach((function(e){t.menu.append(e)}));return this||n};a.next=function(e){var t=(this||n).menu.find(".active").removeClass("active");var r=t.next();r.length||(r=(this||n).menu.find("li").first());r.addClass("active")};a.prev=function(e){var t=(this||n).menu.find(".active").removeClass("active");var r=t.prev();r.length||(r=(this||n).menu.find("li").last());r.addClass("active")};a.listen=function(){var e=this||n;e.element.on("blur",e.blur.bind(e)).on("keypress",e.keypress.bind(e)).on("keyup",e.keyup.bind(e)).on("keydown",e.keydown.bind(e));e.menu.on("click",e.click.bind(e)).on("mouseenter","li",e.mouseenter.bind(e))};a.move=function(e){if((this||n).shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()}};a.keydown=function(e){(this||n).suppressKeyPressRepeat=[40,38,9,13,27].indexOf(e.keyCode)>=0;this.move(e)};a.keypress=function(e){(this||n).suppressKeyPressRepeat||this.move(e)};a.keyup=function(e){var t=this||n;switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!t.shown)return;t.select();break;case 27:if(!t.shown)return;t.hide();break;default:t.lookup()}e.stopPropagation();e.preventDefault()};a.blur=function(e){var t=this||n;setTimeout((function(){t.hide()}),150)};a.click=function(e){e.stopPropagation();e.preventDefault();this.select()};a.mouseenter=function(e){(this||n).menu.find(".active").removeClass("active");s(e.currentTarget).addClass("active")};r=Typeahead;var u=r;export default u;

